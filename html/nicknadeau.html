<!DOCTYPE html>
<html>
	<head>
		<title>Nick Nadeau - nicknadeau</title>
		<meta name="description" content="Nick Nadeau's nicknadeau page.">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link href="https://fonts.googleapis.com/css?family=Cutive Mono" rel="stylesheet">
		<link href="/styles/style-main.css" rel="stylesheet">
	</head>
	<body>
		<span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> "nicknadeau.h" </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> <unistd.h> </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> <stdlib.h> </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> <stdbool.h> </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> <stdint.h> </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> <limits.h> </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="compiler-directive">#include</span> <errno.h> </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">LINK(about) </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">LINK(blog) </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">LINK(github) </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">LINK(native) </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">void</span> printInstructions() { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">printf( </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"To display a specific page, write the name of the page and then hit ENTER.\n" </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"To list the pages, write 'list' and then hit ENTER.\n" </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"To stop running, write 'exit' and then hit ENTER. Or, you know, the good ole CTRL+C.\n" </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">); </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">void</span> list() { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">printf( </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"\nPages: 'about', 'native', 'github', 'blog [post id]'" </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"\n\nNote: the 'post id' of a blog post is the number in square brackets listed on the blog page." </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"\nTo view the blog page itself and not a specific post, omit the post id." </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">"\n" </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">); </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">bool</span> stringEquals(const <span class="c-keyword">char</span> *expected, <span class="c-keyword">const</span> <span class="c-keyword">char</span> *buffer, <span class="c-keyword">uint32_t</span> bufferSize) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">uint32_t</span> expectedSize = strlen(expected); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">return</span> (expectedSize == bufferSize) && (0 == strncmp(expected, buffer, expectedSize)); </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">bool</span> stringBeginsWith(const <span class="c-keyword">char</span> *prefix, <span class="c-keyword">const</span> <span class="c-keyword">char</span> *buffer, <span class="c-keyword">uint32_t</span> bufferSize) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">uint32_t</span> prefixSize = strlen(prefix); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">return</span> (prefixSize <= bufferSize) && (0 == strncmp(prefix, buffer, prefixSize)); </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">uint32_t</span> getBlogPostId(const <span class="c-keyword">char</span> *buffer, <span class="c-keyword">uint32_t</span> bufferSize, <span class="c-keyword">bool</span> *out_hasId, <span class="c-keyword">bool</span> *out_isInvalidId) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">bool</span> hasId = false; </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">uint32_t</span> prefixSize = strlen("blog"); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">uint32_t</span> id; </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">if</span> (prefixSize < bufferSize) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px"><span class="c-keyword">long</span> value = strtol(buffer + prefixSize, NULL, 10); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px"><span class="c-keyword">if</span> ((LONG_MIN == value) || (LONG_MAX == value)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">*out_isInvalidId = true; </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">return</span> 0; </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">id = (uint32_t) value; </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">hasId = true; </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">*out_hasId = hasId; </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">return</span> id; </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">void</span> displayBlogPost(uint32_t postId) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">printf("Displaying post %u\n", postId); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">//TODO implement <span class="c-keyword">for</span> real. </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">static</span> <span class="c-keyword">void</span> printPagePreamble(const <span class="c-keyword">char</span> *pageName, <span class="c-keyword">uint32_t</span> nameLength) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">printf("\n===> Page: %.*s\n\n", nameLength, pageName); </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"></span>
		<br><span class="cutive-mono-16" style="margin-left: 0px"><span class="c-keyword">int</span> main(int argc, <span class="c-keyword">const</span> <span class="c-keyword">char</span> **argv) </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">{ </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">char</span> buffer[BUFSIZ]; </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">printInstructions(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">printf("\n# "); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">fflush(stdout); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">int</span> bytesRead = read(STDIN_FILENO, buffer, BUFSIZ); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">while</span> (bytesRead > 0) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px"><span class="c-keyword">uint32_t</span> bufferSize = bytesRead - 1; </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px"><span class="c-keyword">if</span> (BUFSIZ == bytesRead) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">fprintf(stderr, "...What exactly are you trying to do?\n"); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">return</span> 1; </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (stringEquals("exit", buffer, bufferSize)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">return</span> 0; </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (stringEquals("list", buffer, bufferSize)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">list(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (stringEquals("about", buffer, bufferSize)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">printPagePreamble(buffer, bufferSize); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">about(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (stringEquals("native", buffer, bufferSize)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">printPagePreamble(buffer, bufferSize); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">native(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (stringEquals("github", buffer, bufferSize)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">printPagePreamble(buffer, bufferSize); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">github(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (stringBeginsWith("blog", buffer, bufferSize)) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">bool</span> hasId = false; </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">bool</span> isInvalidId = false; </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">uint32_t</span> postId = getBlogPostId(buffer, bufferSize, &hasId, &isInvalidId); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px"><span class="c-keyword">if</span> (isInvalidId) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 100px">fprintf(stderr, "Invalid 'post id' given. Must be an integer.\n"); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">} <span class="c-keyword">else</span> <span class="c-keyword">if</span> (hasId) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 100px">displayBlogPost(postId); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">} <span class="c-keyword">else</span> { </span>
		<br><span class="cutive-mono-16" style="margin-left: 100px">printPagePreamble(buffer, bufferSize); </span>
		<br><span class="cutive-mono-16" style="margin-left: 100px">blog(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} <span class="c-keyword">else</span> { </span>
		<br><span class="cutive-mono-16" style="margin-left: 75px">printInstructions(); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">printf("\n# "); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">fflush(stdout); </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">bytesRead = read(STDIN_FILENO, buffer, BUFSIZ); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">if</span> (0 == bytesRead) { </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">fprintf(stderr, "**Exiting -> stdin was closed!\n"); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">} <span class="c-keyword">else</span> { </span>
		<br><span class="cutive-mono-16" style="margin-left: 50px">fprintf(stderr, "**Exiting -> error reading stdin! errno=%d\n", errno); </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px">} </span>
		<br><span class="cutive-mono-16" style="margin-left: 25px"><span class="c-keyword">return</span> 1; </span>
		<br><span class="cutive-mono-16" style="margin-left: 0px">} </span>
	</body>
</html>
